
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Embedded Controller (EC) · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="display-configuration.html" />
    
    
    <link rel="prev" href="disabling-touchid.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../a-guide-to-build-guides.html">
            
                <a href="../a-guide-to-build-guides.html">
            
                    
                    A Guide to Build Guides
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Before you start</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../before-you-start/know-your-hardware.html">
            
                <a href="../before-you-start/know-your-hardware.html">
            
                    
                    Know Your Hardware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../before-you-start/bios-configuration.html">
            
                <a href="../before-you-start/bios-configuration.html">
            
                    
                    BIOS Configuration
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Necessary Skills & Terminology</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../useful-skills-terminology/a-little-unix-never-hurt-anyone.html">
            
                <a href="../useful-skills-terminology/a-little-unix-never-hurt-anyone.html">
            
                    
                    A Little UNIX Never Hurt Anyone!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../useful-skills-terminology/just-enough-git.html">
            
                <a href="../useful-skills-terminology/just-enough-git.html">
            
                    
                    Just Enough GIT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../useful-skills-terminology/whats-an-efi.html">
            
                <a href="../useful-skills-terminology/whats-an-efi.html">
            
                    
                    What's an EFI?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../useful-skills-terminology/what-about-kexts.html">
            
                <a href="../useful-skills-terminology/what-about-kexts.html">
            
                    
                    What about KEXTs?
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Installing macOS</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="preparing-the-usb-media.html">
            
                <a href="preparing-the-usb-media.html">
            
                    
                    Preparing the USB Media
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="clover-template.html">
            
                <a href="clover-template.html">
            
                    
                    OpenCore Template
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="setting-up-input-devices.html">
            
                <a href="setting-up-input-devices.html">
            
                    
                    Setting up Input Devices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="disabling-touchid.html">
            
                <a href="disabling-touchid.html">
            
                    
                    Disabling TouchID lookup
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.5" data-path="embedded-controller-ec.html">
            
                <a href="embedded-controller-ec.html">
            
                    
                    Embedded Controller (EC)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="display-configuration.html">
            
                <a href="display-configuration.html">
            
                    
                    Display Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="usb-pre-setup.html">
            
                <a href="usb-pre-setup.html">
            
                    
                    USB pre-setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="pre-installation-review.html">
            
                <a href="pre-installation-review.html">
            
                    
                    Pre-Installation Review
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Installing</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../installing/installing-the-operating-system.html">
            
                <a href="../installing/installing-the-operating-system.html">
            
                    
                    Installing the Operating System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../installing/troubleshooting.html">
            
                <a href="../installing/troubleshooting.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Post Installation</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../post-installation/adding-opencore-to-the-bios.html">
            
                <a href="../post-installation/adding-opencore-to-the-bios.html">
            
                    
                    Adding OpenCore to Your Boot Drive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../post-installation/configuring-usb-ports.html">
            
                <a href="../post-installation/configuring-usb-ports.html">
            
                    
                    Configuring USB Ports
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../post-installation/enabling-wifi-and-bluetooth.html">
            
                <a href="../post-installation/enabling-wifi-and-bluetooth.html">
            
                    
                    Enabling WIFI & Bluetooth
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../post-installation/setting-up-ethernet-adapters.html">
            
                <a href="../post-installation/setting-up-ethernet-adapters.html">
            
                    
                    Setting up Ethernet Adapters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="../post-installation/configuring-your-audio-device.html">
            
                <a href="../post-installation/configuring-your-audio-device.html">
            
                    
                    Configuring your Audio Device
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Battery/Power Management</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../battery-power-management/locate-that-missing-battery.html">
            
                <a href="../battery-power-management/locate-that-missing-battery.html">
            
                    
                    Locate that Missing Battery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../battery-power-management/correcting-sleep-problems.html">
            
                <a href="../battery-power-management/correcting-sleep-problems.html">
            
                    
                    Correcting Sleep Problems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="../battery-power-management/optimizing-battery-life.html">
            
                <a href="../battery-power-management/optimizing-battery-life.html">
            
                    
                    Optimizing Battery Life
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Extras</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../extras/enabling-filevault.html">
            
                <a href="../extras/enabling-filevault.html">
            
                    
                    Enabling FileVault
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="../extras/display-rotation.html">
            
                <a href="../extras/display-rotation.html">
            
                    
                    Display Rotation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="../extras/dual-booting-with-bluetooth-devices.html">
            
                <a href="../extras/dual-booting-with-bluetooth-devices.html">
            
                    
                    Dual booting​ with Bluetooth Devices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="../extras/asussmc.html">
            
                <a href="../extras/asussmc.html">
            
                    
                    ASUS Function Keys
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Embedded Controller (EC)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="embedded-controller-ec">Embedded Controller (EC)</h1>
<h2 id="embedded-controller-ec">Embedded Controller (EC)</h2>
<p>Starting in macOS 10.15 (Catalina), macOS now stalls when booting and attaching to an EC with the device id of &quot;PNP0C09&quot; and is not named EC within the ACPI tables. This normally manifests itself as messages similar to <code>apfs_module_start...</code> or <code>waiting for root device</code> when attempting to boot. With a desktop, we would normally just put in a fake embedded controller with the correct properties and call it a day - but for laptops we rename the existing embedded controller in order to get battery status working. The general gist is that:</p>
<ol>
<li>You need to dump your DSDT</li>
<li>Decompile said DSDT</li>
<li>Figure out which EC is the main one in your DSDT</li>
<li>Put in the right rename into the patches section of your Config.plist</li>
</ol>
<p>For more info, you can <a href="https://khronokernel.github.io/EC-fix-guide/" target="_blank">read this guide,</a> also by Hackintosh Slav. This page is more or less a copy and paste from the laptop page specifically.</p>
<h2 id="dumping-the-dsdt">Dumping the DSDT</h2>
<h4 id="maciasl"><a href="https://github.com/acidanthera/MaciASL/releases" target="_blank">MaciASL</a></h4>
<ul>
<li>When you open MaciASL, it should open directly to your system&apos;s DSDT. If it does not, you can go into the top left corner and hit &quot;File&quot; -&gt; &quot;New from ACPI&quot; -&gt; &quot;DSDT&quot;. What you are seeing is the decompiled form of your DSDT, so you can skip ahead to figuring out which EC you need.</li>
<li>This needs to be done on the target computer, and if you have any ACPI fixes or patches applied from Clover or OpenCore, those will be applied to the DSDT you see in MaciASL.</li>
</ul>
<h4 id="ssdttime"><a href="https://github.com/corpnewt/SSDTTime" target="_blank">SSDTTime</a></h4>
<ul>
<li>Can be ran on either Windows or Linux</li>
<li>If you don&apos;t have an internet connection on that device, or are using Python 2 (or iasl otherwise fails to download) you may need to download <code>iASL</code> and put it in the <code>scripts</code> folder.<ul>
<li><a href="https://bitbucket.org/RehabMan/acpica/downloads/iasl.zip" target="_blank">macOS</a></li>
<li><a href="https://acpica.org/sites/acpica/files/iasl-win-20180105.zip" target="_blank">Windows</a><ul>
<li>You also want <code>acpidump.exe</code> in the <code>sripts</code> folder as well.</li>
</ul>
</li>
<li><a href="http://amdosx.kellynet.nl/iasl.zip" target="_blank">Linooox</a></li>
</ul>
</li>
</ul>
<h4 id="acpidumpexe"><a href="https://acpica.org/sites/acpica/files/iasl-win-20180105.zip" target="_blank">acpidump.exe</a></h4>
<ul>
<li>In command prompt run <code>path/to/acpidump.exe -b -n DSDT -z</code>, this will dump your DSDT as a .dat file. Rename this to DSDT.aml</li>
</ul>
<h4 id="pressing-f4-in-clover">Pressing F4 in Clover</h4>
<ul>
<li>This dumps your DSDT in <code>EFI/CLOVER/ACPI/origin</code>. This folder must exist bfeore you dump though.</li>
</ul>
<h4 id="acpidumpefi"><a href="https://github.com/dortania/OpenCore-Desktop-Guide/raw/master/extra-files/acpidump.efi.zip" target="_blank">acpidump.efi</a></h4>
<ul>
<li>Add this to <code>EFI/OC/Tools</code> and in your config under <code>Misc -&gt; Tools</code> with the argument: <code>-b -n DSDT -z</code>. Select this option in OpenCore&apos;s picker, then rename DSDT.dat to DSDT.aml. </li>
<li>If OpenCore is having issues running acpidump, you can call it from the shell with OpenShell, which is bundled within <a href="https://github.com/acidanthera/OpenCorePkg/releases" target="_blank">OpenCorePkg</a> (reminder to add to both <code>EFI/OC/Tools</code> and in your config under <code>Misc -&gt; Tools</code>):</li>
</ul>
<pre><code class="lang-text">shell&gt; fs0: // replace with proper drive

fs0:\&gt; dir // to verify this is the right directory

Directory of fs0:\

01/01/01 3:30p EFI

fs0:\&gt; cd EFI\OC\Tools // note that it&apos;s with forward slashes

fs0:\EFI\OC\Tools&gt; acpidump.efi -b -n DSDT
</code></pre>
<h2 id="decompiling-the-dsdt">Decompiling the DSDT</h2>
<p>So once we have our DSDT we still got a bit of work left, we&apos;ll first want to decompile it so we can view it easier. Couple options:</p>
<h3 id="macos">macOS</h3>
<p>So decompiling DSDTs is quite easy with macOS, all you need is <a href="https://github.com/acidanthera/MaciASL" target="_blank">MaciASL</a>. To decompile, just open the file!</p>
<h3 id="windows">Windows</h3>
<p>Decompiling on windows is fairly simple as well, you will need <a href="https://acpica.org/sites/acpica/files/iasl-win-20180105.zip" target="_blank">iasl.exe</a> and Command Prompt:</p>
<pre><code class="lang-text">path/to/iasl.exe path/to/DSDT.aml
</code></pre>
<p><img src="https://cdn.discordapp.com/attachments/456913818467958789/668211002340409404/unknown.png" alt=""></p>
<h3 id="linux">Linux</h3>
<p>Compiling and decompiling with Linux is just as simple, you will need a special copy of <a href="http://amdosx.kellynet.nl/iasl.zip" target="_blank">iasl</a> and terminal:</p>
<pre><code class="lang-text">path/to/iasl path/to/DSDT.aml
</code></pre>
<h2 id="finding-the-right-ec-patch">Finding the right EC patch</h2>
<p>Now that our DSDT is readable, next search for <code>PNP0C09</code>. Should give you something similar to this:</p>
<p><img src="https://i.imgur.com/lQ4kpb9.png" alt=""></p>
<p>As you can see our <code>PNP0C09</code> is found within the <code>Device (EC0)</code> meaning this is the device we want to rename.</p>
<blockquote>
<p>What happens if multiple <code>PNP0C09</code> show up</p>
</blockquote>
<p>When this happens you need to figure out which is the main and which is not, it&apos;s fairly easy to figure out. Check each controller for the following properties:</p>
<ul>
<li><code>_HID</code></li>
<li><code>_CRS</code></li>
<li><code>_GPE</code></li>
</ul>
<p>Note that only the main EC needs renaming, if you only have one <code>PNP0C09</code> then it is automatically your main regardless of properties.</p>
<h2 id="applying-your-ec-patch">Applying your EC patch</h2>
<p>As you can see from the table below, we&apos;ll be renaming our EC listed in the DSDT. Do note you cannot just throw random renames without checking first, as this can cause actual damage to your laptop.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Comment</th>
<th style="text-align:left">Find*[HEX]</th>
<th style="text-align:left">Replace[HEX]</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">change EC0 to EC</td>
<td style="text-align:left">4543305f</td>
<td style="text-align:left">45435f5f</td>
</tr>
<tr>
<td style="text-align:left">change H_EC to EC</td>
<td style="text-align:left">485f4543</td>
<td style="text-align:left">45435f5f</td>
</tr>
<tr>
<td style="text-align:left">change ECDV to EC</td>
<td style="text-align:left">45434456</td>
<td style="text-align:left">45435f5f</td>
</tr>
<tr>
<td style="text-align:left">change PGEC to EC</td>
<td style="text-align:left">50474543</td>
<td style="text-align:left">45435f5f</td>
</tr>
</tbody>
</table>
<p>Add the rename as shown below:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Comment</th>
<th style="text-align:left">Type</th>
<th style="text-align:left">Change XXXX to EC</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Enabled</td>
<td style="text-align:left">Boolean</td>
<td style="text-align:left">YES</td>
</tr>
<tr>
<td style="text-align:left">Count</td>
<td style="text-align:left">Number</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">Limit</td>
<td style="text-align:left">Nuber</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">Find</td>
<td style="text-align:left">Data</td>
<td style="text-align:left">xxxxxxxx</td>
</tr>
<tr>
<td style="text-align:left">Replace</td>
<td style="text-align:left">Data</td>
<td style="text-align:left">xxxxxxxx</td>
</tr>
</tbody>
</table>
<p><img src="https://cdn.discordapp.com/attachments/456913818467958789/668667268254793728/Screen_Shot_2020-01-19_at_9.04.50_PM.png" alt=""></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="disabling-touchid.html" class="navigation navigation-prev " aria-label="Previous page: Disabling TouchID lookup">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="display-configuration.html" class="navigation navigation-next " aria-label="Next page: Display Configuration">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Embedded Controller (EC)","level":"4.5","depth":1,"next":{"title":"Display Configuration","level":"4.6","depth":1,"path":"prepare-install-macos/display-configuration.md","ref":"prepare-install-macos/display-configuration.md","articles":[]},"previous":{"title":"Disabling TouchID lookup","level":"4.4","depth":1,"path":"prepare-install-macos/disabling-touchid.md","ref":"prepare-install-macos/disabling-touchid.md","articles":[]},"dir":"ltr"},"config":{"plugins":["theme-default","-lunr","-search","search-plus","addcssjs","hints"],"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"fontsettings":{"theme":"night","family":"sans","size":2},"addcssjs":{"css":[],"js":["scripts/search.js"]},"search-plus":{},"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"highlight":{},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":[]},"theme-default":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}}},"theme":"default","pdf":{"pageBreaksBefore":"/","headerTemplate":null,"paperSize":"a4","margin":{"right":62,"left":62,"top":36,"bottom":36},"fontSize":12,"fontFamily":"Arial","footerTemplate":null,"chapterMark":"pagebreak","pageNumbers":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"links":{"sharing":{"google":false,"facebook":false,"twitter":false,"weibo":false,"all":false}},"gitbook":"*"},"file":{"path":"prepare-install-macos/embedded-controller-ec.md","mtime":"2020-05-18T16:18:06.835Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-05-18T16:18:57.057Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    
    <script type="text/javascript" src="../scripts/search.js"></script>
    

    </body>
</html>

